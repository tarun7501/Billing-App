<div class="p-8" *ngIf="bill; else notFound">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
        <div class="flex items-center gap-4">
            <button (click)="goBack()" class="p-2 rounded hover:bg-slate-100">‚Üê</button>
            <div>
                <h1 class="text-3xl font-semibold text-slate-800">Bill Details</h1>
                <p class="text-slate-500 mt-1">{{ bill.billNumber }}</p>
            </div>
        </div>

        <div class="flex gap-3">
            <button class="px-4 py-2 border rounded flex items-center gap-2" (click)="downloadPDF()">
                ‚¨á Download PDF
            </button>

            <button class="px-4 py-2 border rounded flex items-center gap-2" (click)="shareWhatsApp()">
                üì§ Share via WhatsApp
            </button>

            <button
                *ngIf="bill.status === 'Pending'"
                class="px-4 py-2 bg-green-600 text-white rounded flex items-center gap-2 hover:bg-green-700"
                (click)="markAsCleared()"
            >
                ‚úî Mark as Cleared
            </button>
        </div>
    </div>

    <div class="max-w-5xl space-y-6">
        <!-- Bill Overview -->
        <div class="bg-white rounded-lg border p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold">Bill Overview</h2>
                <span
                    class="px-4 py-1 rounded text-sm"
                    [ngClass]="{
            'bg-green-100 text-green-700': bill.status === 'Cleared',
            'bg-amber-100 text-amber-700': bill.status === 'Pending'
          }"
                >
                    {{ bill.status }}
                </span>
            </div>

            <div class="grid grid-cols-2 gap-6">
                <div>
                    <p class="text-sm text-slate-500">Bill Number</p>
                    <p class="text-lg font-semibold">{{ bill.billNumber }}</p>
                </div>
                <div>
                    <p class="text-sm text-slate-500">Bill Date</p>
                    <p class="text-lg font-semibold">{{ bill.date | date:'dd MMMM yyyy' }}</p>
                </div>
            </div>
        </div>

        <!-- Customer Details -->
        <div class="bg-white rounded-lg border p-6">
            <h2 class="text-lg font-semibold mb-4">Customer Details</h2>

            <div class="grid grid-cols-3 gap-6">
                <div>
                    <p class="text-sm text-slate-500">Customer Name</p>
                    <p class="text-lg font-semibold">{{ bill.customerName }}</p>
                </div>
                <div>
                    <p class="text-sm text-slate-500">Phone Number</p>
                    <p class="text-lg font-semibold">{{ bill.phone }}</p>
                </div>
                <div>
                    <p class="text-sm text-slate-500">Email Address</p>
                    <p class="text-lg font-semibold">{{ bill.email || '‚Äî' }}</p>
                </div>
            </div>
        </div>

        <!-- Bill Items -->
        <div class="bg-white rounded-lg border p-6 space-y-6">
            <h2 class="text-lg font-semibold mb-4">Bill Items</h2>
            <!-- Mobile -->
            <div *ngIf="bill.mobilePhotoItems.length">
                <h3 class="text-lg font-semibold mb-3">Mobile Photo</h3>
                <table class="w-full border">
                    <thead class="bg-slate-50">
                        <tr>
                            <th>Photo Size</th>
                            <th>Copies</th>
                            <th>Unit Price</th>
                            <th class="text-right">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let i of bill.mobilePhotoItems">
                            <td>{{ i.photoSize }}</td>
                            <td>{{ i.numberOfCopies }}</td>
                            <td>‚Çπ{{ i.unitPrice }}</td>
                            <td class="text-right font-semibold">‚Çπ{{ i.total }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Studio -->
            <div *ngIf="bill.studioPhotoItems.length">
                <h3 class="text-lg font-semibold mb-3">Studio Photo</h3>
                <table class="w-full border">
                    <thead class="bg-slate-50">
                        <tr>
                            <th>Photo Size</th>
                            <th>Copies</th>
                            <th>Extra</th>
                            <th>Unit Price</th>
                            <th class="text-right">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let i of bill.studioPhotoItems">
                            <td>{{ i.photoSize }}</td>
                            <td>{{ i.numberOfCopies }}</td>
                            <td>{{ i.extraCopies || 0 }}</td>
                            <td>‚Çπ{{ i.unitPrice }}</td>
                            <td class="text-right font-semibold">‚Çπ{{ i.total }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Lamination -->
            <div *ngIf="bill.laminationItems.length">
                <h3 class="text-lg font-semibold mb-3">Photo With Lamination</h3>
                <table class="w-full border">
                    <thead class="bg-slate-50">
                        <tr>
                            <th>Size</th>
                            <th>Copies</th>
                            <th>Type</th>
                            <th>Finish</th>
                            <th>Unit Price</th>
                            <th class="text-right">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let i of bill.laminationItems">
                            <td>{{ i.photoSize }}</td>
                            <td>{{ i.numberOfCopies }}</td>
                            <td>{{ i.laminationType }}</td>
                            <td>{{ i.laminationFinish }}</td>
                            <td>‚Çπ{{ i.unitPrice }}</td>
                            <td class="text-right font-semibold">‚Çπ{{ i.total }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pricing Breakdown -->
        <div class="border-2 border-blue-100 bg-blue-50/30 rounded-lg p-6">
            <h2 class="text-lg font-semibold text-blue-900 mb-4">Pricing Breakdown</h2>

            <div class="space-y-3">
                <div class="flex justify-between">
                    <span>Subtotal</span>
                    <span>‚Çπ{{ bill.subtotal }}</span>
                </div>
                <div class="flex justify-between text-red-600">
                    <span>Discount</span>
                    <span>- ‚Çπ{{ bill.discount }}</span>
                </div>
                <div class="flex justify-between text-xl font-bold text-blue-600">
                    <span>Total</span>
                    <span>‚Çπ{{ bill.totalAmount }}</span>
                </div>
                <div class="flex justify-between text-green-600">
                    <span>Advance</span>
                    <span>‚Çπ{{ bill.advanceAmount }}</span>
                </div>
                <div
                    class="flex justify-between text-xl font-bold"
                    [ngClass]="bill.balanceAmount > 0 ? 'text-amber-600' : 'text-green-600'"
                >
                    <span>Balance</span>
                    <span>‚Çπ{{ bill.balanceAmount }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-template #notFound>
    <div class="p-8 text-center">
        <p class="text-slate-500">Bill not found.</p>
        <button class="mt-4 px-4 py-2 border rounded" (click)="goBack()">Go Back</button>
    </div>
</ng-template>
