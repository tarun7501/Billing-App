<div *ngIf="isLoading" class="flex items-center justify-center h-[60vh]">
    <p class="text-slate-500 text-lg">Loading bills...</p>
</div>

<div *ngIf="!isLoading" class="p-8">
    <div class="flex items-center justify-between mb-8">
        <div>
            <h1 class="text-3xl font-semibold text-slate-800">Bills</h1>
            <p class="text-slate-500 mt-1">Manage all your billing records</p>
        </div>

        <button
            (click)="createBill()"
            class="flex items-center gap-2 px-6 py-3 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
            >
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v14M5 12h14" />
            </svg>
            Create Bill
        </button>
    </div>
    <div class="mb-6">
        <div class="relative max-w-md">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
            >
                <circle cx="11" cy="11" r="8" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-4.3-4.3" />
            </svg>
            <input
                type="text"
                [(ngModel)]="searchQuery"
                (ngModelChange)="onSearchChange()"
                placeholder="Search by Bill ID, Phone, or Customer Name..."
                class="pl-10 h-12 w-full rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
        </div>
    </div>

    <div class="bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden">
        <table class="w-full border-collapse">
            <thead class="bg-slate-50">
                <tr>
                    <th class="th">Bill Number</th>
                    <th class="th">Date</th>
                    <th class="th">Customer Name</th>
                    <th class="th">Phone</th>
                    <th class="th">Total Amount</th>
                    <th class="th">Balance Amount</th>
                    <th class="th">Status</th>
                    <th class="th text-right">Action</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let bill of filteredBills; let i = index" [class.bg-slate-50/50]="i % 2 !== 0">
                    <td class="td font-medium">{{ bill.billNumber }}</td>
                    <td class="td text-slate-600">{{ bill.date | date:'dd MMM yyyy' }}</td>
                    <td class="td">{{ bill.customerName }}</td>
                    <td class="td text-slate-600">{{ bill.phone }}</td>
                    <td class="td font-medium">₹{{ bill.totalAmount | number:'1.0-0' }}</td>
                    <td class="td font-medium">₹{{ bill.balanceAmount | number:'1.0-0' }}</td>
                    <td class="td">
                        <span
                            class="px-3 py-1 rounded-full text-sm font-medium"
                            [ngClass]="{
                'bg-green-100 text-green-700': bill.status === 'Cleared',
                'bg-amber-100 text-amber-700': bill.status === 'Pending'
              }"
                        >
                            {{ bill.status }}
                        </span>
                    </td>
                    <td class="td text-right">
                        <button
                            (click)="viewBill(bill.id)"
                            class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 px-3 py-1.5 rounded"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="w-4 h-4"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    d="M1.5 12s4-7.5 10.5-7.5S22.5 12 22.5 12s-4 7.5-10.5 7.5S1.5 12 1.5 12z"
                                />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                            View
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div *ngIf="filteredBills.length === 0" class="text-center py-12 bg-white rounded-lg border border-slate-200 mt-6">
        <p class="text-slate-500">No bills found matching your search.</p>
    </div>
</div>
